(function(e){function t(t){for(var a,r,c=t[0],i=t[1],u=t[2],b=0,m=[];b<c.length;b++)r=c[b],Object.prototype.hasOwnProperty.call(l,r)&&l[r]&&m.push(l[r][0]),l[r]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);s&&s(t);while(m.length)m.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,c=1;c<n.length;c++){var i=n[c];0!==l[i]&&(a=!1)}a&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},l={app:0},o=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var s=i;o.push([1,"chunk-vendors"]),n()})({0:function(e,t){},"0093":function(e){e.exports=JSON.parse('{"title":{"text":""},"tooltip":{},"legend":{"data":[],"show":true,"selectedMode":true},"xAxis":{"data":[],"nameLocation":"end","nameGap":25,"nameTextStyle":{"fontWeight":"normal","fontSize":12}},"yAxis":{},"series":[]}')},1:function(e,t,n){e.exports=n("cd49")},"1c58":function(e,t,n){},2:function(e,t){},"2de6":function(e,t,n){},"2e5d":function(e,t,n){},3:function(e,t){},"3f07":function(e,t,n){"use strict";n("2e5d")},4e3:function(e,t,n){"use strict";n("1c58")},5030:function(e,t,n){"use strict";n("f088")},"6aa1":function(e,t,n){"use strict";n("d053")},bb02:function(e,t,n){"use strict";n("2de6")},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23");function l(e,t,n,l,o,r){var c=Object(a["K"])("MainPanel");return Object(a["D"])(),Object(a["i"])(c)}function o(e,t,n,l,o,r){var c=Object(a["K"])("Chart"),i=Object(a["K"])("MenuPanel"),u=Object(a["K"])("Sheet"),s=Object(a["K"])("DataTable");return Object(a["D"])(),Object(a["i"])("div",null,[Object(a["m"])(c),Object(a["m"])(i),Object(a["m"])(u),Object(a["m"])(s)])}var r=n("5502"),c={id:"echarts"};function i(e,t,n,l,o,r){return Object(a["D"])(),Object(a["i"])("div",c)}n("94b1"),n("e057"),n("007d"),n("d28f"),n("627c");var u=n("3eba");function s(e,t,n){try{t.clearFlag&&(e.clear(),n()),e.setOption(t)}catch(a){console.error("Error happens, render the chart"),console.error(a),e.clear(),e.dispose(),e=u["init"](document.getElementById("echarts")),e.setOption(t)}}var b=Object(a["n"])({name:"chart",setup:function(){var e=Object(r["b"])(),t=e.getters.option,n=function(){e.dispatch("turnOffClear")},l={};Object(a["A"])((function(){l=u["init"](document.getElementById("echarts")),l.setOption(t),Object(a["Y"])((function(){s(l,e.getters.option,n)}))}))}});n("5030");b.render=i;var m=b,d=(n("b0c0"),{id:"menu-container"}),f=Object(a["m"])("label",null,"Title:",-1),p=Object(a["m"])("label",null,"Legend:",-1),O=Object(a["m"])("h2",null,"X Axis:",-1),j=Object(a["m"])("label",null,"Name:",-1),h=Object(a["m"])("label",null,"Location:",-1),v=Object(a["m"])("option",null,"start",-1),g=Object(a["m"])("option",null,"center",-1),y=Object(a["m"])("option",null,"end",-1),x=Object(a["m"])("label",null,"fontWeight:",-1),D=Object(a["m"])("option",null,"normal",-1),S=Object(a["m"])("option",null,"bold",-1),A=Object(a["m"])("option",null,"lighter",-1),V=Object(a["m"])("label",null,"size:",-1),w=Object(a["m"])("label",null,"gap:",-1),C=Object(a["m"])("h2",null,"Y Axis:",-1),U=Object(a["m"])("label",null,"Name:",-1),I=Object(a["m"])("label",null,"Location:",-1),k=Object(a["m"])("option",null,"start",-1),F=Object(a["m"])("option",null,"center",-1),M=Object(a["m"])("option",null,"end",-1),P=Object(a["m"])("h2",null,"Series:",-1),N=Object(a["m"])("label",null,"Name:",-1),T=Object(a["m"])("hr",null,null,-1);function E(e,t,n,l,o,r){return Object(a["D"])(),Object(a["i"])("div",d,[Object(a["m"])("form",null,[Object(a["m"])("div",null,[f,Object(a["ab"])(Object(a["m"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.model.title.text=t}),type:"text"},null,512),[[a["V"],e.model.title.text]])]),Object(a["m"])("div",null,[p,Object(a["ab"])(Object(a["m"])("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.model.legend.show=t})},null,512),[[a["S"],e.model.legend.show]])]),Object(a["m"])("div",null,[O,Object(a["m"])("div",null,[j,Object(a["ab"])(Object(a["m"])("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=function(t){return e.model.xAxis.name=t})},null,512),[[a["V"],e.model.xAxis.name]])]),Object(a["m"])("div",null,[h,Object(a["ab"])(Object(a["m"])("select",{"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.model.xAxis.nameLocation=t})},[v,g,y],512),[[a["U"],e.model.xAxis.nameLocation]])]),Object(a["m"])("div",null,[x,Object(a["ab"])(Object(a["m"])("select",{"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.model.xAxis.nameTextStyle.fontWeight=t})},[D,S,A],512),[[a["U"],e.model.xAxis.nameTextStyle.fontWeight]])]),Object(a["m"])("div",null,[V,Object(a["ab"])(Object(a["m"])("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=function(t){return e.model.xAxis.nameTextStyle.fontSize=t}),min:"1",max:"100"},null,512),[[a["V"],e.model.xAxis.nameTextStyle.fontSize]])]),Object(a["m"])("div",null,[w,Object(a["ab"])(Object(a["m"])("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=function(t){return e.model.xAxis.nameGap=t}),min:"0",max:"50"},null,512),[[a["V"],e.model.xAxis.nameGap]])])]),Object(a["m"])("div",null,[C,Object(a["m"])("div",null,[U,Object(a["ab"])(Object(a["m"])("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=function(t){return e.model.yAxis.name=t})},null,512),[[a["V"],e.model.yAxis.name]])]),Object(a["m"])("div",null,[I,Object(a["ab"])(Object(a["m"])("select",{"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.model.yAxis.nameLocation=t})},[k,F,M],512),[[a["U"],e.model.yAxis.nameLocation]])])]),Object(a["m"])("div",null,[P,(Object(a["D"])(!0),Object(a["i"])(a["b"],null,Object(a["I"])(e.model.series,(function(t,n){return Object(a["D"])(),Object(a["i"])("div",{key:n},[N,Object(a["ab"])(Object(a["m"])("input",{"onUpdate:modelValue":function(e){return t.name=e},onInput:function(a){return e.model.legend.data[n]=t.name},type:"text"},null,40,["onUpdate:modelValue","onInput"]),[[a["V"],t.name]]),Object(a["ab"])(Object(a["m"])("input",{"onUpdate:modelValue":function(e){return t.itemStyle.color=e},type:"color"},null,8,["onUpdate:modelValue"]),[[a["V"],t.itemStyle.color]]),T])})),128))])])])}var L=Object(a["n"])({name:"menu-panel",setup:function(){var e=Object(r["b"])(),t=e.getters.option;return{model:t}}});n("4000");L.render=E;var _=L,z={id:"table"};function J(e,t){return Object(a["D"])(),Object(a["i"])("div",z)}var B=n("e325"),K=(n("2bd6"),function(e){var t="";if(e<0)return t;e++;while(e>0){var n=(e-1)%26;t=String.fromCharCode(65+n)+t,e=Math.floor((e-1)/26)}return t}),W=function(e){for(var t=0,n=0;n<e.length;n++)t=26*t+e.charCodeAt(n)-64;return t-1},G=function(e){var t=0;for(var n in e)Array.isArray(e[n])&&(t=Math.max(e[n].length,t));return t},Y=function(e){for(var t=[],n=0;n<e.length;n++){for(var a=[],l=0;l<e[n].length;l++)a.push(e[n][l]);t.push(a)}return t};function R(e){for(var t=Y(e),n=G(t),a=[{title:"",field:"",width:40,resizable:!1,frozen:!0,formatter:function(e){return e.getElement().style.backgroundColor="#e6e6e6",e.getValue()}}],l=0;l<n;l++)a.push({title:K(l),field:K(l),editor:"input"});for(var o=[],r=0;r<t.length;r++){var c={"":r};o.push(c);for(var i=0;i<t[r].length;i++)c[K(i)]=t[r][i]}return{columns:a,tableData:o}}function X(e,t){var n=R(e);return new B["a"](document.getElementById("table"),{data:n.tableData,layout:"fitColumns",columns:n.columns,headerVisible:!1,cellEdited:function(e){var n=e.getData()[""],a=W(e.getColumn().getField()),l=e.getValue();t(n,a,l)}})}function Z(e,t){e.setColumns(t.columns),e.replaceData(t.tableData)}var $=Object(a["n"])({name:"data-table",setup:function(){var e=Object(r["b"])(),t=function(t,n,a){e.dispatch("updateChartData",{row:t,col:n,value:a})};Object(a["A"])((function(){var n=X(e.getters.chartData,t);Object(a["Y"])((function(){Z(n,R(e.getters.chartData))}))}))}});n("bb02");$.render=J;var q=$,H={style:{display:"none"},type:"file",id:"file",ref:"file"},Q=Object(a["l"])("Click to upload"),ee={key:0},te={key:1},ne=Object(a["m"])("hr",null,null,-1);function ae(e,t,n,l,o,r){var c=Object(a["K"])("el-button");return Object(a["D"])(),Object(a["i"])("div",null,[Object(a["m"])("input",H,null,512),Object(a["m"])("div",null,[Object(a["m"])(c,{size:"small",type:"primary",onClick:t[1]||(t[1]=function(t){return e.$refs.file.click()})},{default:Object(a["Z"])((function(){return[Q]})),_:1}),e.fileUpload.file?(Object(a["D"])(),Object(a["i"])("span",ee,"File: "+Object(a["O"])(e.fileUpload.file.name),1)):(Object(a["D"])(),Object(a["i"])("span",te,"No file chosen"))]),ne])}n("4160"),n("159b");var le=n("1146"),oe=n.n(le),re=function(e){var t={};return e.SheetNames.forEach((function(n){var a=oe.a.utils.sheet_to_json(e.Sheets[n],{header:1});a.length&&(t[n]=a)})),t},ce=Object(a["n"])({name:"sheet",components:{},setup:function(){var e=Object(r["b"])(),t=Object(a["F"])({file:null}),n=function(n){var a=n.target.files[0];if(t.file=a,a){var l=new FileReader;l.onload=function(t){var n=t.target.result,a=oe.a.read(n,{type:"binary"}),l=re(a),o=[];for(var r in l)o.push(r);e.dispatch("setSheets",o),e.dispatch("setFileData",l)},l.readAsBinaryString(a),console.log(t)}};return Object(a["A"])((function(){var e=document.getElementById("file");e.addEventListener("change",n,!1)})),{fileUpload:t}}});n("3f07");ce.render=ae;var ie=ce,ue=n("e7f1"),se=Object(a["n"])({name:"main-panel",components:{Chart:m,MenuPanel:_,DataTable:q,Sheet:ie},setup:function(){var e=Object(r["b"])();e.dispatch("setChartData",ue)}});se.render=o;var be=se,me=Object(a["n"])({name:"app",components:{MainPanel:be}});n("6aa1");me.render=l;var de=me,fe=n("0093"),pe=n("e1a9"),Oe=function(e){return e>=pe.length&&(e%=pe.length),pe[e]},je=function(e){for(var t=JSON.parse(JSON.stringify(fe)),n=1;n<e[0].length;n++)t.xAxis.data.push(e[0][n]);for(var a=t.legend.data,l=1;l<e.length;l++){a.push(e[l][0]);var o={type:"bar",data:[],itemStyle:{}};t.series.push(o),o.name=e[l][0],o.itemStyle.color=Oe(l-1);for(var r=1;r<e[l].length;r++)o.data.push(e[l][r])}return t},he=function(e,t){var n=t.row,a=t.col,l=t.value;0===n&&0===a||(0===n?e.xAxis.data[a-1]=l:0===a?(e.legend.data[n-1]=l,e.series[n-1].name=l):e.series[n-1].data[a-1]=l)},ve=[],ge={},ye=Object(r["a"])({state:{chartData:ve,option:ge,fileData:{},sheets:[]},mutations:{setOption:function(e,t){Object.assign(e.option,t)},setChartData:function(e,t){e.chartData=t},updateChartData:function(e,t){var n=t.row,a=t.col,l=t.value;e.chartData[n][a]=l},setFileData:function(e,t){e.fileData=t},setSheets:function(e,t){e.sheets=t}},getters:{option:function(e){return e.option},chartData:function(e){return e.chartData},fileData:function(e){return e.fileData},sheets:function(e){return e.sheets}},actions:{setOption:function(e,t){var n=e.commit;n("setOption",t)},setChartData:function(e,t){var n=e.commit;n("setChartData",t);var a=je(t);a.clearFlag=!0,n("setOption",a)},updateChartData:function(e,t){e.commit;var n=e.state,a=t.row,l=t.col,o=t.value;n.chartData[a][l]=o,he(n.option,{row:a,col:l,value:o})},setFileData:function(e,t){var n=e.commit,a=e.dispatch,l=e.state;n("setFileData",t),a("setChartData",t[l.sheets[0]])},setSheets:function(e,t){var n=e.commit;n("setSheets",t)},turnOffClear:function(e){e.commit;var t=e.state;t.option.clearFlag=!1}}}),xe=n("3fd4"),De=(n("7dd6"),Object(a["h"])(de));De.use(ye),De.use(xe["a"]),De.mount("#app")},d053:function(e,t,n){},e1a9:function(e){e.exports=JSON.parse('["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"]')},e7f1:function(e){e.exports=JSON.parse('[["","Item 1","Item 2","Item 3","Item 4","Item 5"],["Series A",10,15,20,25,50],["Series B",30,25,20,15,10]]')},f088:function(e,t,n){}});
//# sourceMappingURL=app.6b82bfec.js.map